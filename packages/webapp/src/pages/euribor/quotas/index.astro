---
import BaseLayout from '~/layouts/BaseLayout.astro';
import CheckboxCard from '~/components/CheckboxCard.astro';

const periods = [
  { label: 'Euribor 3M',  value: 'quota3m' },
  { label: 'Euribor 6M',  value: 'quota6m' },
  { label: 'Euribor 12M', value: 'quota12m' },
];
const canonical = new URL('/euribor/quotas/', Astro.site!).href;

// --- INÍCIO DA ADIÇÃO: JSON-LD COMO PEDIDO ---
const howToSchema = {
    "@context": "https://schema.org",
    "@type": "HowTo",
    "name": "Como Comparar a Quota de Mercado da Euribor",
    "description": "Use a ferramenta do Ativos.pt para selecionar diferentes prazos da Euribor e comparar a sua popularidade nos novos contratos de crédito à habitação em Portugal.",
    "step": [
        {
            "@type": "HowToStep",
            "name": "Selecionar Prazos da Euribor",
            "text": "Marque as caixas de seleção para os prazos da Euribor (3M, 6M, 12M) que deseja comparar. Pode selecionar de 1 a 3 prazos.",
            "url": canonical
        },
        {
            "@type": "HowToStep",
            "name": "Visualizar Comparação",
            "text": "Clique no botão 'Comparar Quotas' para ver um gráfico dinâmico com a evolução histórica da quota de mercado para os prazos que selecionou."
        }
    ]
};
---

<BaseLayout
  title="Comparador de Quota de Mercado da Euribor"
  description="Escolha até 3 prazos da Euribor (3M, 6M, 12M) para comparar a sua quota de mercado nos novos contratos de crédito."
>
  <Fragment slot="head">
    <link rel="canonical" href={canonical} />
  </Fragment>

  <article class="max-w-4xl mx-auto py-12 px-4 space-y-12">
    <div>
      <a href="/euribor" class="flex items-center gap-2 text-primary font-semibold mb-8 hover:underline">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M7.707 14.707a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l2.293 2.293a1 1 0 010 1.414z" clip-rule="evenodd" />
        </svg>
        Voltar ao Observatório de Taxas
      </a>

      <div class="text-center">
        <h1 class="text-4xl md:text-6xl font-extrabold mb-4">
          Comparador de Quota de Mercado
        </h1>
        <p class="text-gray-600 dark:text-gray-400 mb-10">
          Selecione até 3 prazos para comparar a percentagem de novos créditos indexados a cada um.
        </p>
      </div>

      <form id="euribor-form" class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-8">
        {periods.map(p => (
          <CheckboxCard value={p.value} label={p.label} />
        ))}
      </form>

      <div class="text-center">
        <button
          id="compare-btn"
          class="bg-primary text-white font-bold py-3 px-8 rounded-full hover:opacity-90 transition-opacity"
        >
          Comparar Quotas
        </button>
      </div>
    </div>

    <section class="bg-gray-100 dark:bg-gray-800/50 p-8 rounded-2xl border border-gray-200 dark:border-gray-700 text-center">
        <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-3">Complemente a sua Análise</h2>
        <p class="text-gray-600 dark:text-gray-400 mb-6 max-w-2xl mx-auto">
            As taxas Euribor são apenas uma parte do puzzle. Visite o nosso Observatório do Imobiliário para uma visão completa do mercado, incluindo a evolução dos preços das casas, o risco de crédito e muito mais.
        </p>
        <a href="/imobiliario" class="inline-block bg-white dark:bg-gray-700 text-primary dark:text-white px-8 py-3 rounded-full font-bold shadow-lg hover:scale-105 transition-transform border border-gray-200 dark:border-gray-600">
            Explorar Hub Imobiliário
        </a>
    </section>

  </article>

  <script is:inline>
    const form = document.getElementById('euribor-form');
    const btn  = document.getElementById('compare-btn');
    btn.addEventListener('click', e => {
      e.preventDefault();
      const sel = [...form.querySelectorAll('input[type="checkbox"]:checked')].map(i => i.value);
      if (sel.length < 1) { alert('Selecione pelo menos 1 prazo.'); return; }
      if (sel.length > 3) { alert('Máximo 3 prazos.'); return; }
      
      window.location.href = `/euribor/quotas/${sel.join('-vs-')}`;
    });
  </script>
</BaseLayout>