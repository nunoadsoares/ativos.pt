---
import type { CollectionEntry } from 'astro:content';
import logoImage from '~/assets/logo.png';

interface Props {
  entry: CollectionEntry<'plataformas'>;
}
const { entry } = Astro.props;
const { data, slug } = entry;

const siteUrl = Astro.site?.href ?? 'https://www.ativos.pt';
const pageUrl = new URL(`/plataformas/${slug}`, siteUrl).href;

const schema = {
  "@context": "https://schema.org",
  "@type": "Review",
  "itemReviewed": {
    "@type": "FinancialProduct",
    "name": data.nome,
    "url": pageUrl,
    "logo": new URL(data.logo, siteUrl).href,
    "brand": {
        "@type": "Organization",
        "name": data.nome
    }
  },
  "reviewRating": {
    "@type": "Rating",
    "ratingValue": data.rating ?? "4.5", // Podes adicionar um campo 'rating' ao teu frontmatter
    "bestRating": "5",
    "worstRating": "1"
  },
  "author": {
    "@type": "Organization",
    "name": "Ativos.pt",
    "url": siteUrl
  },
  "publisher": {
    "@type": "Organization",
    "name": "Ativos.pt",
    "logo": {
      "@type": "ImageObject",
      "url": new URL(logoImage.src, siteUrl).href
    }
  },
  "headline": `Análise à ${data.nome}`,
  "description": data.description,
  "inLanguage": "pt-PT",
  "mainEntityOfPage": pageUrl
};
---

<script type="application/ld+json" is:inline set:html={JSON.stringify(schema)} />