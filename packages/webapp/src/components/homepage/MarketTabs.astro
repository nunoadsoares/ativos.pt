---
// C:\Users\nunos\Desktop\ativos.pt\packages\webapp\src\components\homepage\MarketTabs.astro
import StockSparklineCard from './StockSparklineCard.astro';
import { Icon } from 'astro-icon/components';

const { marketData } = Astro.props;

// Exatamente 4 por secção
const portugueseStocks = marketData?.portugueseStocks?.slice(0, 4) ?? [];
const topGainers = marketData?.topGainers?.slice(0, 4) ?? [];
---
<div id="mercado" class="mt-16 text-left w-full">
  <div class="mx-auto w-full max-w-7xl px-4 sm:px-6 lg:px-8">
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 md:gap-12">

      <!-- Mercado Nacional -->
      <div class="flex flex-col">
        <div class="mb-6">
          <h3 class="text-2xl font-bold text-gray-900 dark:text-white">Mercado Nacional</h3>
          <p class="text-gray-500 dark:text-gray-400 mt-1">As principais ações da bolsa portuguesa.</p>
        </div>

        {portugueseStocks.length > 0 ? (
          <!-- 2 colunas fixas -> 2x2 com 4 cards -->
          <div class="grid grid-cols-2 gap-4">
            {portugueseStocks.map((stock) => (
              <div class="min-w-0">
                <StockSparklineCard {...stock} />
              </div>
            ))}
          </div>
        ) : (
          <div class="flex-grow flex items-center justify-center text-center p-8 bg-gray-100 dark:bg-gray-800/50 rounded-lg">
            <p class="text-gray-500 dark:text-gray-400">A carregar dados do mercado nacional...</p>
          </div>
        )}
      </div>

      <!-- Destaques Globais -->
      <div class="flex flex-col">
        <div class="mb-6">
          <h3 class="text-2xl font-bold text-gray-900 dark:text-white">Destaques Globais</h3>
          <p class="text-gray-500 dark:text-gray-400 mt-1">As ações com maior valorização no mercado internacional.</p>
        </div>

        {topGainers.length > 0 ? (
          <!-- 2 colunas fixas -> 2x2 com 4 cards -->
          <div class="grid grid-cols-2 gap-4">
            {topGainers.map((stock) => (
              <div class="min-w-0">
                <StockSparklineCard {...stock} />
              </div>
            ))}
          </div>
        ) : (
          <div class="flex-grow flex items-center justify-center text-center p-8 bg-gray-100 dark:bg-gray-800/50 rounded-lg">
            <p class="text-gray-500 dark:text-gray-400">A carregar destaques globais...</p>
          </div>
        )}
      </div>

    </div>

    <div class="mt-12 text-center">
      <a
        href="/acoes"
        class="inline-flex w-full sm:w-auto justify-center items-center gap-2 px-6 py-3 font-semibold text-white bg-primary rounded-lg shadow-lg hover:opacity-90 transition-all transform hover:scale-105"
      >
        <span>Explorar Todos os Mercados</span>
        <Icon name="heroicons:arrow-right-solid" class="h-5 w-5" />
      </a>
    </div>
  </div>
</div>
